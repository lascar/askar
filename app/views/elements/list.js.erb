/*jslint browser: true, nomen: true*/
/*global $, jQuery*/
// http://jsperf.com/jquery-vs-createelement
// depiste of that we use a mixt with jquery for compatibility in browsers
var Elemental = {
  init_elemental: function () {
    'use strict';
    this.display_tab(this.controller);
    this.display_tab_content(this.controller, this.fields, this.elements);
  },

  //this 2 lines are for jslint verification
  //fields: ["id", "name", "description"],
  //elements: [{id: 1, name: "toto"}, {id: 2, name: "tata"}],
  //controller: "toto",
  fields: <%= fields.to_json.html_safe %>,
  elements: <%= elements.to_json.html_safe %>,
  controller: "<%= params[:controller] %>",

  //var element_raw, field_content_div;
  display_tab: function (controller) {
    'use strict';
    var tab = $("<div id='tab_" + controller + "' class='tab'></div>");
    tab.text(controller);
    $("#tabs").append(tab);
  },
  display_tab_content: function (controller, fields, elements) {
    'use strict';
    var tab_content = $("<div id='tab_content_" + controller + "' class='tab_content active'></div>");
    var element_raw, field_content_div;
    $.each(elements, function (index, element) {
      element_raw = $("<div id='element_raw_" + element.id + "'></div>");
      $.each(fields, function (index, field) {
        field_content_div = $("<div id='" + controller + "_" + element.id + "_ " + field + "'></div>");
        field_content_div.text(element[field]);
        element_raw.append(field_content_div);
      });
      tab_content.append(element_raw);
      $("#tabs_contents").append(tab_content);
    });
  }
};

Elemental.init_elemental();

